name: Test GitHub Secrets

on:
  workflow_dispatch:  # Permite ejecución manual

jobs:
  test-secrets:
    runs-on: ubuntu-latest
    
    steps:
    - name: Test AWS Credentials Setup
      run: |
        echo "🧪 Probando configuración de GitHub Secrets..."
        echo ""
        
        # Mostrar algunos valores (no los sensibles completos)
        echo "1. AWS_REGION: ${{ secrets.AWS_REGION }}"
        echo "2. DYNAMODB_TABLE: ${{ secrets.DYNAMODB_TABLE }}"
        
        # Verificar que existen sin mostrar valores completos
        if [ -n "${{ secrets.AWS_ACCESS_KEY_ID }}" ]; then
          echo "✅ AWS_ACCESS_KEY_ID: CONFIGURADO (longitud correcta)"
        else
          echo "❌ AWS_ACCESS_KEY_ID: NO configurado"
          exit 1
        fi
        
        if [ -n "${{ secrets.AWS_SECRET_ACCESS_KEY }}" ]; then
          echo "✅ AWS_SECRET_ACCESS_KEY: CONFIGURADO"
        else
          echo "❌ AWS_SECRET_ACCESS_KEY: NO configurado"
          exit 1
        fi
        
        if [ -n "${{ secrets.AWS_REGION }}" ]; then
          echo "✅ AWS_REGION: CONFIGURADO"
        else
          echo "❌ AWS_REGION: NO configurado"
          exit 1
        fi
        
        if [ -n "${{ secrets.DYNAMODB_TABLE }}" ]; then
          echo "✅ DYNAMODB_TABLE: CONFIGURADO"
        else
          echo "❌ DYNAMODB_TABLE: NO configurado"
          exit 1
        fi
        
        echo ""
        echo "🎉 ¡TODOS LOS SECRETS CONFIGURADOS CORRECTAMENTE!"
        echo "Ahora podemos continuar con CI/CD completo."
